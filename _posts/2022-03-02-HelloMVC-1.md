---
title: "[웹 서버] Hello MVC #1"
author:
  name: define_chan
  link: https://eucha09.github.io/about/
date: 2022-03-02 14:59:00 +0900
categories: [웹 서버(Web Server), ASP.NET Core 둘러보기]
tags: [MVC]     # TAG names should always be lowercase
---

## **ASP.NET Core 소개**

**ASP.NET Core**는 Microsoft에서 개발한 **웹 프레임워크**이다.   
할 수 있는 작업으로는 C#으로 웹앱 및 서비스 등을 빌드할 수 있으며, Blazor를 사용하면 C#으로 웹 프론트엔드까지 작업이 가능하다.

ASP.NET Core로 작업할 수 있는 프로젝트 형태는 아래와 같다.
* **MVC**
* **Razor Pages**
* **WebAPI**
* **Blazor Server**
* **Blazor Client**

## **MVC**

**MVC**는 **Model View Controller**의 약자로 애플리케이션을 세가지 역할로 구분한 디자인 패턴이다.   
Model은 데이터를 어떻게 정의하고 관리할 것인지를 담당하고, View는 사용자에게 시각적으로 어떻게 보여줄 것인지를 담당하고, Controller는 동작에 관한 부분을 담당한다.
* **M (Model)** - 데이터
* **V (View)** - UI
* **C (Controller)** - 동작

## **MVC 프로젝트 생성**

Visual Studio에서 '새 프로젝트 생성 > ASP.NET Core 웹 애플리케이션 > 웹 응용 프로그램(모델-뷰-컨트롤러)'를 선택해 MVC 프로젝트를 생성해 볼 수 있다.

프로젝트를 열어보면 Controllers, Models, Views로 구분되어 관리되고 있는 것을 볼 수 있으며,   
Program.cs를 열어보면 Main함수가 있는 것을 볼 수 있다. 이는 우리가 프로그래밍 언어를 배울 때 많이 보던 형식으로 ASP.NET Core 프로젝트 또한 콘솔 프로그램이라는 것을 의미한다.

![MVC구조](/assets/img/posts/webserver/MVC구조.png){: w="800"}
_MVC 프로젝트 구조_

이대로 컴파일하여 실행시켜보면 아래와 같은 웹페이지가 뜰 것이다.

![HelloMVC](/assets/img/posts/webserver/HelloMVC.png){: w="800"}
_ASP.NET Core MVC 웹페이지 화면_

## **빈 프로젝트에서 시작**

방금은 MVC 템플릿을 이용하여 프로젝트를 생성해보고 바로 실행해보았지만 지금은 MVC 동작원리 등을 알아보기 위해 빈 프로젝트에서 하나하나씩 부품 맞추기 형식으로 MVC구조를 살펴보겠다.

### **빈 프로젝트 생성**

새 프로젝트 생성 > ASP.NET Core 웹 애플리케이션 > 비어 있음을 선택해 빈 프로젝트를 생성한다.

빈 프로젝트를 생성하였다면 먼저 Models, Views, Controllers 폴더를 생성하고 Views 폴더안에는 Home이라는 폴더를 생성해놓자.
* Controllers
* Models
* Views
  * Home
* Program.cs
* Startup.cs

### **Models**

다음 Models 폴더 안에 '새 항목 추가 > 클래스 > 파일이름 HelloMessage.cs'를 생성하여 간단한 메세지를 표현할 데이터를 정의해보자.

```c#
namespace HelloEmpty.Models
{
    public class HelloMessage
    {
        public string Message { get; set; }
    }
}
```

### **Controllers**

다음 Controllers 폴더로 가서는 '새 항목 추가 > 컨트롤러 클래스 - 비어 있 > 파일이름 HomeController.cs'를 생성하여 Home에 있는 Index 페이지를 열었을 때 어떤 데이터를 표현해주면 되는지 전달해보자.

```c#
public class HomeController : Controller
{
    public IActionResult Index()
    {
        HelloMessage msg = new HelloMessage()
        {
            Message = "Welcome to Asp.Net MVC !"
        };

        ViewBag.Noti = "Input message and click submit"; // ViewBag을 이용하여 View에 데이터를 넘겨줄 수 있음.

        return View(msg); // 어떤 UI를 표시해주면 되는지 반환
    }
}
```

주의할 점은 Controller 이름과 함수 이름을 작성할때 View에 있는 페이지 이름과 맞게 작성해야한다. (예: Home안에 Index 페이지 -> HomeController 클래스 안에 Index() 함수)

### **Views**

다음으로는 Views 폴더로 가서 방금 작성한 Controller와 연동 될 View를 생성한다. '새 항목 추가 > Razor 뷰 - 비어 있음 > 파일이름 Index.cshtml'

.cshtml 파일은 C#과 HTML이 섞여있는 파일로 ASP.NET Core에서 자체적으로 활용하고 있는 파일형식이다.

Index.cshtml 파일을 생성하였다면 아래와 같이 작성해보자.

```html
@model HelloEmpty.Models.HelloMessage

<html>
<head>
    <title>Hello MVC !</title>
</head>
<body>
    <h1>@Model.Message</h1>
    <hr />
    <h2>@ViewBag.Noti</h2>

    <form asp-controller="Home" asp-action="Index" method="post">
        <label asp-for="Message">Enter Message</label>
        <br />
        <input type="text" asp-for="Message" />
        <br />
        <button type="submit">Submit</button>
    </form>

</body>
</html>
```

코드를 보면 HTML 태그를 사용하고 있는 것을 볼 수 있지만 기존 HTML과 다르게 @가 많이 보이는 것을 알 수 있다.   
@부분은 C#코드를 의미한다고 생각하면 된다.

코드를 하나하나 살펴보자면
```html
@model HelloEmpty.Models.HelloMessage
```
첫 줄에 나오는 부분은 HelloEmpty.Models.HelloMessage를 사용하겠다는 의미이다.

```html
<h1>@Model.Message</h1>
<hr />
<h2>@ViewBag.Noti</h2>
```

@없이 그냥 Model.Message라고 입력하면 그냥 문자열이 되지만 @를 붙이면 C#코드처럼 Model.Message에 접근하여 데이터를 가져오게 된다.

```html
<form asp-controller="Home" asp-action="Index" method="post">
    <label asp-for="Message">Enter Message</label>
    <br />
    <input type="text" asp-for="Message" />
    <br />
    <button type="submit">Submit</button>
</form>
```

HTML 태그로 입력 폼을 작성한 것인데 submit 버튼을 누르면 HomeController에 있는 Index를 post 형식으로 호출하게 된다.

추가적으로 _ViewImports.cshtml 파일을 추가해주어야하는데   
'새 항목 추가 > Razor 뷰 가져오기'를 선택해서 생성하고 아래와 같이 작성해놓으면 된다.

[https://thebook.io/006824/ch26/10/05/](https://thebook.io/006824/ch26/10/05/)
```html
@using HelloEmpty
@using HelloEmpty.Models
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
```
